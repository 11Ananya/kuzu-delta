-GROUP TinySnbReadTest
-DATASET CSV load-from-test

--

-CASE CastStringToList
-STATEMENT LOAD WITH HEADERS (list INT64[][], a struct(num INT64, str STRING)) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/should_pass.csv" RETURN *;
---- 7
[[1,3,423,124,43242],[432]]|{num: -423432, str: this is a string []}
[[1,3,423,124,43242],[432]]|{num: 3423423, str: this is a string}
[[1,3,423,124,43242],[432]]|{num: 3424231143, str: this is a normal string no space ' , , does not count'}
[,[],[1,2,3]]|{num: 0, str: this is a string}
[,,,,,,,,,,[1,2,3]]|{num: 1, str: yes}
[[],[],[]]|{num: 2341, str: no}
[,,]|{num: 0, str: }
-STATEMENT LOAD WITH HEADERS (list STRING[], str STRING, struct STRUCT(a STRUCT(b STRUCT(c INT64[])))) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/change_config.csv" (HEADER=true, DELIM="|", ESCAPE="~", QUOTE="'", LIST_BEGIN="(", LIST_END=")") RETURN * ;
---- 3
[escape , is escape success? ~]| ' ( ) do not need to escape sepeical | ()|{a: {b: {c: []}}}
[this , is a word , normal not escape , ' ( ) | , ~ ' ]|try escape ~|{a: {b: {c: [3432423,-43423,31231,]}}}
[~ ' not work also this "'" ]|nu|{a: {b: {c: []}}}

-CASE ErrorTest
-STATEMENT LOAD WITH HEADERS (list STRING[][]) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/delim_fail.csv" (DELIM="|", ESCAPE="~", QUOTE="'", LIST_BEGIN="(", LIST_END=")") RETURN * ;
---- error
Conversion exception: Cast failed. "((hello),(bdfadf),)" is not in STRING[][] range.
-STATEMENT LOAD WITH HEADERS (list STRING[][]) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/bracket_fail.csv" (DELIM="|", ESCAPE="~", LIST_BEGIN="(", LIST_END=")") RETURN * ;
---- error
Conversion exception: Cast failed. (() is not in STRING[][] range.
-STATEMENT LOAD WITH HEADERS (list INT32[]) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/quote_fail.csv" RETURN * ;
---- error
Binder exception: Number of columns mismatch. Detect 3 but expect 1.
-STATEMENT LOAD WITH HEADERS (list STRING[]) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/single_quote.csv" RETURN *;
---- error
Conversion exception: Cast failed. ['fdsfdsfe werw] is not in STRING[] range.
-STATEMENT LOAD WITH HEADERS (list STRING[]) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/single_quote2.csv" RETURN *;
---- error
Conversion exception: Cast failed. [[' this is a signle quote]] is not in STRING[] range.
-STATEMENT LOAD WITH HEADERS (list UINT8[]) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/single_struct.csv" RETURN *;
---- error
Conversion exception: Cast failed. [{32, 32] is not in UINT8[] range.
-STATEMENT LOAD WITH HEADERS (list UINT8[]) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/conversion_fail.csv" RETURN *;
---- error
Conversion exception: Cast failed. 432412 is not in UINT8 range.
-STATEMENT LOAD WITH HEADERS (q STRUCT(a STRUCT(b STRING))) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/struct_bracket_fail1.csv" RETURN *;
---- error
Conversion exception: Cast failed. {a: {b: fsdf is not in STRUCT(a:STRUCT(b:STRING)) range.
-STATEMENT LOAD WITH HEADERS (q STRUCT(a STRUCT(b STRING))) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/struct_bracket_fail2.csv" RETURN *;
---- error
Conversion exception: Cast failed. {a: {b: fds} is not in STRUCT(a:STRUCT(b:STRING)) range.
-STATEMENT LOAD WITH HEADERS (a STRUCT(c STRING)) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/struct_close_fail.csv" RETURN *;
---- error
Conversion exception: Cast failed. { c : 423 } still stuff here is not in STRUCT(c:STRING) range.
-STATEMENT LOAD WITH HEADERS (a STRUCT(c INT32)) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/invalid_field_name.csv" RETURN *;
---- error
Parser exception: Invalid struct field name: d
-STATEMENT LOAD WITH HEADERS (a STRUCT(c INT32)) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/no_field_name.csv" RETURN *;
---- error
Conversion exception: Cast failed. {c 3423} is not in STRUCT(c:INT32) range.
-STATEMENT LOAD WITH HEADERS (a STRUCT(c INT32)) FROM "${KUZU_ROOT_DIRECTORY}/dataset/load-from-test/struct_quote_fail.csv" RETURN *;
---- error
Conversion exception: Cast failed. { c: 'fdsfs } is not in STRUCT(c:INT32) range.
